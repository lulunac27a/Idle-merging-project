import type { NextPage } from 'next'
import Head from 'next/head'
import { useEffect, useState } from 'react'
import dynamic from 'next/dynamic'

import styles from '../styles/Home.module.css'

import { Aircraft } from '../types/Aircraft.types'
import { Player } from '../types/Player.types'

import { AircraftPanel } from '../components/AircraftPanel'
import { Header } from '../components/Header'
import { Ring } from '../components/Ring'

import Swal from 'sweetalert2'

import {
  handleNewAircraft,
  handleDeleteAircraft,
  handleEditAircraft,
  handleListAircraft,
  handleGetAircraft
} from '../services/crud_aircrafts'

import {
  handleNewPlayer,
  handleEditPlayer,
  handleDeletePlayer,
  handleListPlayer,
  handleGetPlayer
} from '../services/crud_players'

import { DndProvider } from 'react-dnd'
import { HTML5Backend } from 'react-dnd-html5-backend'

const Home: NextPage = () => {

  const [ player, setPlayer ] = useState<Player>()
  
  async function loadPlayerData(){
    const player:Player = await handleGetPlayer(1)
    setPlayer(player)  
  }     

  useEffect(()=>{
    loadPlayerData()
  }, [])  
   
  return (
    <div className={styles.container}>
      <Head>
        <title>IDLE</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        {
          player?
          <Header {...player}/>
          :"Loading..."
        }

        {
          player?
          <DndProvider backend={HTML5Backend}>
            <AircraftPanel playerID={player.id} />
          </DndProvider>
          :"Loading..."
        }

        <Ring />


      </main>

      
    </div>
  )
}

export default Home
